autonumber

actor 利用者
利用者 -> PredictionView : 実行ボタン押下
PredictionView -> PredictionsController : execute

create Prediction
PredictionsController -> Prediction : new
PredictionsController ->> PredictionJob : perform_later

autonumber stop
PredictionView <-- PredictionsController
利用者 <-- PredictionView

alt URL指定
  autonumber resume
  PredictionJob -> NetkeibaClient : http_get_race

  loop レースのエントリーの数だけ繰り返す
    PredictionJob -> NetkeibaClient : http_get_horse
  end

  PredictionJob -> YAML : dump
end

loop レースのエントリーの数だけ繰り返す
  PredictionJob -> "Prediction::Result" : create!
end

PredictionJob -> Prediction : update
