autonumber

aggregate -> Entry : pluck

loop 取得したエントリーだけ繰り返す
  aggregate -> Feature : find_by

  alt 素性が存在する
    opt operation == 'update' or 'upsert'
      aggregate -> aggregate : create_feature

      opt 素性の生成に成功
        aggregate -> Feature : update!
      end
    end
  else
    opt operation == 'create' or 'upsert'
      aggregate -> aggregate : create_feature

      opt 素性の生成に成功
        aggregate -> Feature : create!
      end
    end
  end
end
