autonumber

loop 指定された期間内を日付ごとに繰り返し
  collect -> CollectUtil : get_race_ids

  alt レースIDファイルが存在する
    CollectUtil -> File : read
  else
    CollectUtil -> HTTPClient : get

    autonumber stop
    CollectUtil <-- HTTPClient

    autonumber resume
    CollectUtil -> File : write
  end

  autonumber stop
  collect <-- CollectUtil

  loop レースIDごとに繰り返し
    autonumber resume
    collect -> CollectUtil : get_race_html

    alt レース情報ファイルが存在する
      CollectUtil -> File : read
    else
      CollectUtil -> HTTPClient : get

      autonumber stop
      CollectUtil <-- HTTPClient

      autonumber resume
      CollectUtil -> File : write
    end

    autonumber stop
    collect <-- CollectUtil

    loop レースのエントリーごとに繰り返し
      autonumber resume
      collect -> CollectUtil : get_horse_html

      alt 競走馬情報ファイルが存在しない
        CollectUtil -> HTTPClient : get

        autonumber stop
        CollectUtil <-- HTTPClient

        autonumber resume
        CollectUtil -> File : write
      end

      autonumber stop
      collect <-- CollectUtil

      autonumber resume
      collect -> CollectUtil : get_jockey_html

      alt 騎手情報ファイルが存在しない
        CollectUtil -> HTTPClient : get

        autonumber stop
        CollectUtil <-- HTTPClient

        autonumber resume
        CollectUtil -> File : write
      end

      autonumber stop
      collect <-- CollectUtil
    end
  end
end
