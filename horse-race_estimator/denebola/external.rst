機能仕様
========

機能仕様では以下を定義する

- :ref:`den-ext-resource`
- :ref:`den-ext-api`

.. _den-ext-resource:

リソース
--------

本システムでは以下のリソースを扱う

- :ref:`den-ext-resource-races`
- :ref:`den-ext-resource-entries`
- :ref:`den-ext-resource-results`
- :ref:`den-ext-resource-horses`
- :ref:`den-ext-resource-features`

.. _den-ext-resource-races:

レース
^^^^^^

レース情報を表す

.. csv-table::
   :header: "属性名", "型", "意味", "備考"
   :widths: 15, 10, 30, 45

   "方向", "文字列", "レースが左回りか右回りか", "- 以下のいずれか

     - 左
     - 右"
   "距離", "数値", "コースの距離", "- 0より大きい整数"
   "グレード", "文字列", "レースのグレード", "- 以下のいずれか

     - G1
     - G2
     - G3

   - デフォルト null"
   "場所", "文字列", "レースの開催場所", "- 以下のいずれか

     - 中京
     - 中山
     - 京都
     - 函館
     - 小倉
     - 新潟
     - 札幌
     - 東京
     - 福島
     - 阪神"
   "ラウンド", "数値", "その日の何度目のレースか", "- 0より大きい整数"
   "開催日時", "日時", "レースの開催日時", "- 年/月/日 時:分:秒"
   "地面の種類", "文字列", "コースの地面の種類", "- 以下のいずれか

     - 芝
     - ダ"
   "天候", "文字列", "レース開催日の天候", "- 以下のいずれか

     - 晴
     - 曇
     - 小雨
     - 雨
     - 小雪
     - 雪"

.. _den-ext-resource-entries:

エントリー
^^^^^^^^^^

レースのエントリーを表す

.. csv-table::
   :header: "属性名", "型", "意味", "備考"
   :widths: 15, 10, 30, 45

   "年齢", "数値", "レース参加時の年齢", "- 0より大きい整数"
   "性別", "文字列", "エントリーの性別", "- 以下のいずれか

     - 牝
     - 牡"
   "斤量", "数値", "エントリーの斤量", "- 0より大きい小数"
   "騎手", "文字列", "騎手の名前",
   "馬番", "数値", "エントリーの番号", "- 0より大きい整数"
   "馬体重", "数値", "エントリー時の馬体重", "- 0より大きい整数"
   "体重の差分", "数値", "前走との馬体重の差分", "- 小数"

.. _den-ext-resource-results:

レース結果
^^^^^^^^^^

レースの結果を表す

.. csv-table::
   :header: "属性名", "型", "意味", "備考"
   :widths: 15, 10, 30, 45

   "着順", "数値", "レースで何番目にゴールに着いたか", "- 0より大きい整数"

.. _den-ext-resource-horses:

馬
^^^^

馬を表す

.. csv-table::
   :header: "属性名", "型", "意味", "備考"
   :widths: 15, 10, 30, 45

.. _den-ext-resource-features:

素性
^^^^

レースの分析に利用する特徴量を表す

.. csv-table::
   :header: "属性名", "型", "意味", "備考"
   :widths: 15, 10, 30, 45

   "方向", "文字列", "レースが左回りか右回りか", ":ref:`den-ext-resource-races` 参照"
   "距離", "数値", "コースの距離", ":ref:`den-ext-resource-races` 参照"
   "グレード", "文字列", "レースのグレード", ":ref:`den-ext-resource-races` 参照"
   "場所", "文字列", "レースの開催場所", ":ref:`den-ext-resource-races` 参照"
   "ラウンド", "数値", "その日の何度目のレースか", ":ref:`den-ext-resource-races` 参照"
   "地面の種類", "文字列", "コースの地面の種類", ":ref:`den-ext-resource-races` 参照"
   "天候", "文字列", "レース開催日の天候", ":ref:`den-ext-resource-races` 参照"
   "年齢", "数値", "レース参加時の年齢", ":ref:`den-ext-resource-entries` 参照"
   "性別", "文字列", "エントリーの性別", ":ref:`den-ext-resource-entries` 参照"
   "斤量", "数値", "エントリーの斤量", ":ref:`den-ext-resource-entries` 参照"
   "騎手", "文字列", "騎手の名前", ":ref:`den-ext-resource-entries` 参照"
   "馬番", "数値", "エントリーの番号", ":ref:`den-ext-resource-entries` 参照"
   "馬体重", "数値", "エントリー時の馬体重", ":ref:`den-ext-resource-entries` 参照"
   "体重の差分", "数値", "前走との馬体重の差分", ":ref:`den-ext-resource-entries` 参照"
   "開催月", "数値", "レースの開催月", "- 0より大きい整数"
   "斤量比", "数値", "斤量/馬体重", "- 0より大きい小数"

.. _den-ext-api:

インターフェース
----------------

本システムは以下の機能を備えている

- :ref:`den-ext-api-collect`
- :ref:`den-ext-api-aggregate`

.. _den-ext-api-collect:

リソースを収集する
^^^^^^^^^^^^^^^^^^

外部サイトからレースに関する情報を収集してデータベースに登録する．出力はない

入力
""""

- 収集開始日

  - 指定がなければ7日前の日付となる

- 収集終了日

  - 指定がなければ当日の日付となる

出力
""""

- なし

.. _den-ext-api-aggregate:

リソースを集約する
^^^^^^^^^^^^^^^^^^

収集したリソースを集約して素性を生成する．入出力はない

入力
""""

- なし

出力
""""

- なし
